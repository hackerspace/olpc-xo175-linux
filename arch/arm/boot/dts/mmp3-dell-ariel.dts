// SPDX-License-Identifier: GPL-2.0-or-later OR MIT
/*
 * Dell Wyse 3020 a.k.a. "Ariel" a.k.a. Tx0D (T00D, T10D)
 *
 * Copyright (C) 2019 Lubomir Rintel <lkundrak@v3.sk>
 */

/dts-v1/;
#include "mmp3.dtsi"
#include <dt-bindings/gpio/gpio.h>
#include <dt-bindings/interrupt-controller/irq.h>

/ {
	model = "Dell Ariel";
	compatible = "dell,wyse-ariel", "marvell,mmp3";

	aliases {
		serial2 = &uart3;
	};

	chosen {
		#address-cells = <0x1>;
		#size-cells = <0x1>;
		ranges;
		bootargs = "earlyprintk=ttyS2,115200 console=ttyS2,115200";
	};

	memory@0 {
		available = <0x7f700000 0x7ff00000 0x00000000 0x7f600000>;
		reg = <0x0 0x80000000>;
		device_type = "memory";
	};
};

&uart3 {
	status = "okay";
	pinctrl-names = "default";
	pinctrl-0 = <&uart3_pins>;
};

&rtc {
	status = "okay";
};

&usb_otg0 {
	status = "okay";
};

&usb_otg_phy0 {
	status = "okay";
};

&hsic0 {
	status = "okay";

	usb1@1 {
		compatible = "usb424,2640";
		reg = <0x01>;
		#address-cells = <0x01>;
		#size-cells = <0x00>;

		mass-storage@1 {
			compatible = "usb424,4040";
			reg = <0x01>;
			status = "disabled";
		};
	};
};

&hsic_phy0 {
	status = "okay";
	reset-gpios = <&gpio 63 GPIO_ACTIVE_HIGH>;
};

&mmc3 {
	status = "okay";
	pinctrl-names = "default";
	pinctrl-0 = <&mmc3_pins>;
	max-frequency = <50000000>;
	status = "okay";
	bus-width = <8>;
	non-removable;
	cap-mmc-highspeed;
};

&twsi1 {
	status = "okay";
	pinctrl-names = "default";
	pinctrl-0 = <&twsi1_pins>;

	rtc@68 {
		compatible = "dallas,ds1338";
		reg = <0x68>;
		status = "okay";
	};
};

&twsi3 {
	status = "okay";
	pinctrl-names = "default";
	pinctrl-0 = <&twsi3_pins>;
};

&twsi4 {
	status = "okay";
	pinctrl-names = "default";
	pinctrl-0 = <&twsi4_pins>;

	embedded-controller@58 {
		compatible = "dell,wyse-ariel-ec", "ene,kb3930";
		reg = <0x58>;
		system-power-controller;

		off-gpios = <&gpio 126 GPIO_ACTIVE_HIGH>,
			    <&gpio 127 GPIO_ACTIVE_HIGH>;
	};
};

&ssp1 {
	status = "okay";
	pinctrl-names = "default";
	pinctrl-0 = <&ssp1_pins>;
	cs-gpios = <&gpio 46 GPIO_ACTIVE_LOW>;

	firmware-flash@0 {
		compatible = "winbond,w25q32", "jedec,spi-nor";
		reg = <0>;
		spi-max-frequency = <104000000>;
		m25p,fast-read;
	};
};

&ssp2 {
	status = "okay";
	pinctrl-names = "default";
	pinctrl-0 = <&ssp2_pins>;
	cs-gpios = <&gpio 56 GPIO_ACTIVE_LOW>;
};

&gpu_2d {
	status = "okay";
};

&gpu_3d {
	status = "okay";
};

&pinctrl {
	uart3_pins: pinmux_uart3_pins {
		pinctrl-single,pins = <0x120 1>, <0x124 1>;
	};

	mmc3_pins: pinmux_mmc3_pins {
		pinctrl-single,pins = <0x200 2>, <0x204 2>, <0x208 2>, <0x20c 2>;
	};

	twsi1_pins: pinmux_twsi1_pins {
		pinctrl-single,pins = <0x140 0>, <0x144 0>;
	};

	twsi3_pins: pinmux_twsi3_pins {
		pinctrl-single,pins = <0x2b0 1>, <0x2b4 1>;
	};

	twsi4_pins: pinmux_twsi4_pins {
		pinctrl-single,pins = <0x2bc 0>, <0x2c0 0>;
	};

	twsi5_pins: pinmux_twsi5_pins {
		pinctrl-single,pins = <0x0f8 2>, <0x0fc 2>;
	};

	lcd0_pins: pinmux_lcd0_pins {
		pinctrl-single,pins = <0x170 1>, <0x174 1>, <0x178 1>, <0x17c 1>,
				      <0x180 1>, <0x184 1>, <0x188 1>, <0x18c 1>,
				      <0x190 1>, <0x194 1>, <0x198 1>, <0x19c 1>,
				      <0x1a0 1>, <0x1a4 1>, <0x1a8 1>, <0x1ac 1>,
				      <0x1b0 1>, <0x1b4 1>, <0x1b8 1>, <0x1bc 1>,
				      <0x1c0 1>, <0x1c4 1>, <0x1c8 1>, <0x1cc 1>,
				      <0x1d0 1>, <0x1d4 1>, <0x1d8 1>, <0x1dc 1>;
	};

	ssp1_pins: pinmux_ssp1_pins {
		pinctrl-single,pins = <0x100 3>, <0x104 3>, <0x108 3>;
	};

	ssp2_pins: pinmux_ssp2_pins {
		pinctrl-single,pins = <0x130 1>, <0x138 1>, <0x13c 1>;
	};
};
